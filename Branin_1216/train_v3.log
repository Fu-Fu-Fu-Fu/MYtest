任务开始运行于 r4518u01n01.misha.ycrc.yale.edu at Wed Dec 17 23:52:04 EST 2025
CUDA_VISIBLE_DEVICES: 0
正在使用的显卡信息：
NVIDIA A40
+ python -u src/train_rl_v3.py --variants_path ./data/branin_family_variants.npz --model_path ./model/finetuned_tabpfn_branin_family.ckpt --total_episodes 5000 --max_steps 20 --n_candidates 128 --hidden_dim 64 --n_cross_attn_layers 2 --update_every 20 --save_every 500 --save_dir ./runs/ppo_bo_1216v3_2 --seed 42
/gpfs/radev/pi/cohan/yz979/environment/miniconda3/envs/fl_test/lib/python3.11/site-packages/torch/cuda/__init__.py:61: FutureWarning: The pynvml package is deprecated. Please install nvidia-ml-py instead. If you did not install pynvml directly, please report this to the maintainers of the package that installed pynvml for you.
  import pynvml  # type: ignore[import]

======================================================================
Improved PPO Training for Bayesian Optimization (v3)
======================================================================
Device: cuda
Total Episodes: 5000
Max Steps per Episode: 20
Candidates per Step: 128
Update Every: 20 episodes
网络: hidden=64, self_attn=3, cross_attn=2, heads=8
======================================================================

TensorBoard 日志目录: ./runs/ppo_bo_1216v3_2/tensorboard
环境已创建: 32 个 Branin 变体
PPO 网络参数量: 285,124

开始训练...

Episode    20 | Reward:   7.59 | Regret: 1.7213 | Best: inf | LR: 1.00e-04
Episode    40 | Reward:   7.01 | Regret: 2.2807 | Best: inf | LR: 9.99e-05
Episode    60 | Reward:   7.52 | Regret: 2.0057 | Best: inf | LR: 9.98e-05
Episode    80 | Reward:   7.61 | Regret: 1.9651 | Best: inf | LR: 9.96e-05
Episode   100 | Reward:   7.71 | Regret: 2.0531 | Best: 2.0531 | LR: 9.94e-05
Episode   120 | Reward:   7.46 | Regret: 2.2786 | Best: 2.0531 | LR: 9.91e-05
Episode   140 | Reward:   8.05 | Regret: 2.2382 | Best: 2.0531 | LR: 9.88e-05
Episode   160 | Reward:   7.88 | Regret: 2.3638 | Best: 2.0531 | LR: 9.84e-05
Episode   180 | Reward:   7.81 | Regret: 2.4753 | Best: 2.0531 | LR: 9.80e-05
Episode   200 | Reward:   7.79 | Regret: 2.3843 | Best: 2.0531 | LR: 9.76e-05
Episode   220 | Reward:   8.20 | Regret: 2.1229 | Best: 2.0531 | LR: 9.70e-05
Episode   240 | Reward:   7.94 | Regret: 1.8057 | Best: 1.8057 | LR: 9.65e-05
Episode   260 | Reward:   8.16 | Regret: 1.8230 | Best: 1.8057 | LR: 9.59e-05
Episode   280 | Reward:   8.35 | Regret: 1.7334 | Best: 1.7019 | LR: 9.52e-05
Episode   300 | Reward:   8.19 | Regret: 1.8912 | Best: 1.7019 | LR: 9.46e-05
Episode   320 | Reward:   8.04 | Regret: 2.1402 | Best: 1.7019 | LR: 9.38e-05
Episode   340 | Reward:   8.00 | Regret: 2.3623 | Best: 1.7019 | LR: 9.30e-05
Episode   360 | Reward:   7.42 | Regret: 2.4101 | Best: 1.7019 | LR: 9.22e-05
Episode   380 | Reward:   7.27 | Regret: 2.4037 | Best: 1.7019 | LR: 9.14e-05
Episode   400 | Reward:   7.34 | Regret: 2.1867 | Best: 1.7019 | LR: 9.05e-05
Episode   420 | Reward:   7.06 | Regret: 2.2729 | Best: 1.7019 | LR: 8.95e-05
Episode   440 | Reward:   7.10 | Regret: 2.2700 | Best: 1.7019 | LR: 8.85e-05
Episode   460 | Reward:   7.58 | Regret: 2.2069 | Best: 1.7019 | LR: 8.75e-05
Episode   480 | Reward:   7.92 | Regret: 2.1255 | Best: 1.7019 | LR: 8.64e-05
Episode   500 | Reward:   7.78 | Regret: 2.2236 | Best: 1.7019 | LR: 8.54e-05

模型已保存: ./runs/ppo_bo_1216v3_2/ppo_ep500.pt

Episode   520 | Reward:   7.73 | Regret: 2.0939 | Best: 1.7019 | LR: 8.42e-05
Episode   540 | Reward:   7.77 | Regret: 2.1297 | Best: 1.7019 | LR: 8.31e-05
Episode   560 | Reward:   7.62 | Regret: 2.1972 | Best: 1.7019 | LR: 8.19e-05
Episode   580 | Reward:   7.40 | Regret: 2.2519 | Best: 1.7019 | LR: 8.06e-05
Episode   600 | Reward:   7.54 | Regret: 2.2763 | Best: 1.7019 | LR: 7.94e-05
Episode   620 | Reward:   7.98 | Regret: 2.2056 | Best: 1.7019 | LR: 7.81e-05
Episode   640 | Reward:   7.91 | Regret: 2.0273 | Best: 1.7019 | LR: 7.68e-05
Episode   660 | Reward:   8.29 | Regret: 1.8083 | Best: 1.7019 | LR: 7.55e-05
Episode   680 | Reward:   8.06 | Regret: 1.7659 | Best: 1.7019 | LR: 7.41e-05
Episode   700 | Reward:   8.54 | Regret: 1.7393 | Best: 1.6681 | LR: 7.27e-05
Episode   720 | Reward:   8.44 | Regret: 1.6848 | Best: 1.6264 | LR: 7.13e-05
Episode   740 | Reward:   8.40 | Regret: 1.8524 | Best: 1.6264 | LR: 6.99e-05
Episode   760 | Reward:   7.83 | Regret: 2.0663 | Best: 1.6264 | LR: 6.84e-05
Episode   780 | Reward:   7.97 | Regret: 2.0914 | Best: 1.6264 | LR: 6.69e-05
Episode   800 | Reward:   8.09 | Regret: 1.8995 | Best: 1.6264 | LR: 6.55e-05
Episode   820 | Reward:   8.50 | Regret: 1.7693 | Best: 1.6264 | LR: 6.39e-05
Episode   840 | Reward:   9.03 | Regret: 1.6644 | Best: 1.6264 | LR: 6.24e-05
Episode   860 | Reward:   9.79 | Regret: 1.4818 | Best: 1.4818 | LR: 6.09e-05
Episode   880 | Reward:  10.04 | Regret: 1.4722 | Best: 1.4494 | LR: 5.94e-05
Episode   900 | Reward:   9.53 | Regret: 1.5787 | Best: 1.4468 | LR: 5.78e-05
Episode   920 | Reward:   9.56 | Regret: 1.6832 | Best: 1.4468 | LR: 5.63e-05
Episode   940 | Reward:   9.16 | Regret: 1.5114 | Best: 1.4468 | LR: 5.47e-05
Episode   960 | Reward:   8.95 | Regret: 1.4339 | Best: 1.4266 | LR: 5.31e-05
Episode   980 | Reward:   9.20 | Regret: 1.4804 | Best: 1.3368 | LR: 5.16e-05
Episode  1000 | Reward:   9.01 | Regret: 1.3904 | Best: 1.3368 | LR: 5.00e-05

模型已保存: ./runs/ppo_bo_1216v3_2/ppo_ep1000.pt

Episode  1020 | Reward:   8.94 | Regret: 1.3336 | Best: 1.2949 | LR: 4.84e-05
Episode  1040 | Reward:   9.09 | Regret: 1.5147 | Best: 1.2949 | LR: 4.69e-05
Episode  1060 | Reward:   8.52 | Regret: 1.5520 | Best: 1.2949 | LR: 4.53e-05
Episode  1080 | Reward:   8.34 | Regret: 1.4455 | Best: 1.2949 | LR: 4.37e-05
Episode  1100 | Reward:   8.41 | Regret: 1.4653 | Best: 1.2949 | LR: 4.22e-05
Episode  1120 | Reward:   8.77 | Regret: 1.3168 | Best: 1.2949 | LR: 4.06e-05
Episode  1140 | Reward:   8.78 | Regret: 1.1331 | Best: 1.1027 | LR: 3.91e-05
Episode  1160 | Reward:   9.34 | Regret: 1.1754 | Best: 1.1027 | LR: 3.76e-05
Episode  1180 | Reward:   9.39 | Regret: 1.0179 | Best: 1.0179 | LR: 3.61e-05
Episode  1200 | Reward:   9.46 | Regret: 1.0391 | Best: 0.9498 | LR: 3.45e-05
Episode  1220 | Reward:   9.00 | Regret: 1.2219 | Best: 0.9498 | LR: 3.31e-05
Episode  1240 | Reward:   8.55 | Regret: 1.3460 | Best: 0.9498 | LR: 3.16e-05
Episode  1260 | Reward:   8.88 | Regret: 1.2340 | Best: 0.9498 | LR: 3.01e-05
Episode  1280 | Reward:   8.34 | Regret: 1.4867 | Best: 0.9498 | LR: 2.87e-05
Episode  1300 | Reward:   8.74 | Regret: 1.4010 | Best: 0.9498 | LR: 2.73e-05
Episode  1320 | Reward:   8.69 | Regret: 1.3068 | Best: 0.9498 | LR: 2.59e-05
Episode  1340 | Reward:   9.60 | Regret: 1.2411 | Best: 0.9498 | LR: 2.45e-05
Episode  1360 | Reward:   9.31 | Regret: 1.2942 | Best: 0.9498 | LR: 2.32e-05
Episode  1380 | Reward:   9.57 | Regret: 1.3323 | Best: 0.9498 | LR: 2.19e-05
Episode  1400 | Reward:   9.45 | Regret: 1.3430 | Best: 0.9498 | LR: 2.06e-05
Episode  1420 | Reward:  10.03 | Regret: 1.3162 | Best: 0.9498 | LR: 1.94e-05
Episode  1440 | Reward:  10.01 | Regret: 1.2965 | Best: 0.9498 | LR: 1.81e-05
Episode  1460 | Reward:  10.13 | Regret: 1.2814 | Best: 0.9498 | LR: 1.69e-05
Episode  1480 | Reward:  11.03 | Regret: 1.1485 | Best: 0.9498 | LR: 1.58e-05
Episode  1500 | Reward:  11.28 | Regret: 1.1291 | Best: 0.9498 | LR: 1.46e-05

模型已保存: ./runs/ppo_bo_1216v3_2/ppo_ep1500.pt

Episode  1520 | Reward:  10.95 | Regret: 1.1301 | Best: 0.9498 | LR: 1.36e-05
Episode  1540 | Reward:  10.34 | Regret: 1.1866 | Best: 0.9498 | LR: 1.25e-05
Episode  1560 | Reward:  10.05 | Regret: 1.3514 | Best: 0.9498 | LR: 1.15e-05
Episode  1580 | Reward:   8.90 | Regret: 1.4134 | Best: 0.9498 | LR: 1.05e-05
Episode  1600 | Reward:   8.58 | Regret: 1.4781 | Best: 0.9498 | LR: 9.55e-06
Episode  1620 | Reward:   8.28 | Regret: 1.5426 | Best: 0.9498 | LR: 8.65e-06
Episode  1640 | Reward:   8.52 | Regret: 1.5660 | Best: 0.9498 | LR: 7.78e-06
Episode  1660 | Reward:   8.86 | Regret: 1.3521 | Best: 0.9498 | LR: 6.96e-06
Episode  1680 | Reward:   9.34 | Regret: 1.2466 | Best: 0.9498 | LR: 6.18e-06
Episode  1700 | Reward:   9.61 | Regret: 1.2845 | Best: 0.9498 | LR: 5.45e-06
Episode  1720 | Reward:   9.67 | Regret: 1.2351 | Best: 0.9498 | LR: 4.76e-06
Episode  1740 | Reward:   9.70 | Regret: 1.1563 | Best: 0.9498 | LR: 4.11e-06
Episode  1760 | Reward:   9.32 | Regret: 1.2334 | Best: 0.9498 | LR: 3.51e-06
Episode  1780 | Reward:   9.27 | Regret: 1.3588 | Best: 0.9498 | LR: 2.96e-06
Episode  1800 | Reward:   9.22 | Regret: 1.2961 | Best: 0.9498 | LR: 2.45e-06
Episode  1820 | Reward:   9.35 | Regret: 1.3142 | Best: 0.9498 | LR: 1.99e-06
Episode  1840 | Reward:   9.83 | Regret: 1.3202 | Best: 0.9498 | LR: 1.57e-06
Episode  1860 | Reward:  10.38 | Regret: 1.2811 | Best: 0.9498 | LR: 1.20e-06
Episode  1880 | Reward:  10.31 | Regret: 1.2407 | Best: 0.9498 | LR: 8.86e-07
Episode  1900 | Reward:  10.42 | Regret: 1.2354 | Best: 0.9498 | LR: 6.16e-07
Episode  1920 | Reward:  10.34 | Regret: 1.2887 | Best: 0.9498 | LR: 3.94e-07
Episode  1940 | Reward:   9.95 | Regret: 1.2866 | Best: 0.9498 | LR: 2.22e-07
Episode  1960 | Reward:   9.43 | Regret: 1.3427 | Best: 0.9498 | LR: 9.87e-08
Episode  1980 | Reward:   9.32 | Regret: 1.2644 | Best: 0.9498 | LR: 2.47e-08
Episode  2000 | Reward:   9.01 | Regret: 1.2842 | Best: 0.9498 | LR: 1.00e-04

模型已保存: ./runs/ppo_bo_1216v3_2/ppo_ep2000.pt

Episode  2020 | Reward:   9.24 | Regret: 1.2233 | Best: 0.9498 | LR: 1.00e-04
Episode  2040 | Reward:   9.56 | Regret: 1.2827 | Best: 0.9498 | LR: 1.00e-04
Episode  2060 | Reward:   9.85 | Regret: 1.2238 | Best: 0.9498 | LR: 9.99e-05
Episode  2080 | Reward:  10.16 | Regret: 1.2212 | Best: 0.9498 | LR: 9.99e-05
Episode  2100 | Reward:  10.32 | Regret: 1.1818 | Best: 0.9498 | LR: 9.98e-05
Episode  2120 | Reward:   9.78 | Regret: 1.1881 | Best: 0.9498 | LR: 9.98e-05
Episode  2140 | Reward:   9.19 | Regret: 1.1334 | Best: 0.9498 | LR: 9.97e-05
Episode  2160 | Reward:   9.45 | Regret: 1.1431 | Best: 0.9498 | LR: 9.96e-05
Episode  2180 | Reward:   9.44 | Regret: 1.1520 | Best: 0.9498 | LR: 9.95e-05
Episode  2200 | Reward:   9.68 | Regret: 1.2039 | Best: 0.9498 | LR: 9.94e-05
Episode  2220 | Reward:  10.48 | Regret: 1.2076 | Best: 0.9498 | LR: 9.93e-05
Episode  2240 | Reward:  10.78 | Regret: 1.2887 | Best: 0.9498 | LR: 9.91e-05
Episode  2260 | Reward:  10.44 | Regret: 1.2899 | Best: 0.9498 | LR: 9.90e-05
Episode  2280 | Reward:  11.04 | Regret: 1.2678 | Best: 0.9498 | LR: 9.88e-05
Episode  2300 | Reward:  10.53 | Regret: 1.2071 | Best: 0.9498 | LR: 9.86e-05
Episode  2320 | Reward:  10.31 | Regret: 1.2188 | Best: 0.9498 | LR: 9.84e-05
Episode  2340 | Reward:  10.64 | Regret: 1.1481 | Best: 0.9498 | LR: 9.82e-05
Episode  2360 | Reward:  10.47 | Regret: 1.2276 | Best: 0.9498 | LR: 9.80e-05
Episode  2380 | Reward:  10.30 | Regret: 1.2486 | Best: 0.9498 | LR: 9.78e-05
Episode  2400 | Reward:  10.39 | Regret: 1.2899 | Best: 0.9498 | LR: 9.76e-05
Episode  2420 | Reward:  10.34 | Regret: 1.3065 | Best: 0.9498 | LR: 9.73e-05
Episode  2440 | Reward:  10.02 | Regret: 1.2926 | Best: 0.9498 | LR: 9.70e-05
Episode  2460 | Reward:  10.54 | Regret: 1.1639 | Best: 0.9498 | LR: 9.68e-05
Episode  2480 | Reward:   9.77 | Regret: 1.2239 | Best: 0.9498 | LR: 9.65e-05
Episode  2500 | Reward:  10.06 | Regret: 1.2078 | Best: 0.9498 | LR: 9.62e-05

模型已保存: ./runs/ppo_bo_1216v3_2/ppo_ep2500.pt

Episode  2520 | Reward:  10.33 | Regret: 1.0924 | Best: 0.9498 | LR: 9.59e-05
Episode  2540 | Reward:  10.23 | Regret: 1.0621 | Best: 0.9498 | LR: 9.56e-05
Episode  2560 | Reward:  10.06 | Regret: 1.0242 | Best: 0.9498 | LR: 9.52e-05
Episode  2580 | Reward:  10.85 | Regret: 0.8466 | Best: 0.8409 | LR: 9.49e-05
Episode  2600 | Reward:  11.44 | Regret: 0.7092 | Best: 0.6905 | LR: 9.46e-05
Episode  2620 | Reward:  11.56 | Regret: 0.6541 | Best: 0.6495 | LR: 9.42e-05
Episode  2640 | Reward:  11.78 | Regret: 0.6634 | Best: 0.5794 | LR: 9.38e-05
Episode  2660 | Reward:  11.65 | Regret: 0.6896 | Best: 0.5794 | LR: 9.34e-05
Episode  2680 | Reward:  11.83 | Regret: 0.7178 | Best: 0.5794 | LR: 9.30e-05
Episode  2700 | Reward:  11.91 | Regret: 0.8082 | Best: 0.5794 | LR: 9.26e-05
Episode  2720 | Reward:  11.68 | Regret: 0.8077 | Best: 0.5794 | LR: 9.22e-05
Episode  2740 | Reward:  11.50 | Regret: 0.7532 | Best: 0.5794 | LR: 9.18e-05
Episode  2760 | Reward:  12.12 | Regret: 0.7233 | Best: 0.5794 | LR: 9.14e-05
Episode  2780 | Reward:  11.95 | Regret: 0.7217 | Best: 0.5794 | LR: 9.09e-05
Episode  2800 | Reward:  11.43 | Regret: 0.6126 | Best: 0.5794 | LR: 9.05e-05
Episode  2820 | Reward:  11.72 | Regret: 0.6907 | Best: 0.5794 | LR: 9.00e-05
Episode  2840 | Reward:  12.29 | Regret: 0.7241 | Best: 0.5794 | LR: 8.95e-05
Episode  2860 | Reward:  12.02 | Regret: 0.8172 | Best: 0.5794 | LR: 8.90e-05
Episode  2880 | Reward:  12.12 | Regret: 0.7981 | Best: 0.5794 | LR: 8.85e-05
Episode  2900 | Reward:  12.32 | Regret: 0.9394 | Best: 0.5794 | LR: 8.80e-05
Episode  2920 | Reward:  12.20 | Regret: 0.8411 | Best: 0.5794 | LR: 8.75e-05
Episode  2940 | Reward:  12.28 | Regret: 0.7591 | Best: 0.5794 | LR: 8.70e-05
Episode  2960 | Reward:  12.70 | Regret: 0.6481 | Best: 0.5794 | LR: 8.64e-05
Episode  2980 | Reward:  12.40 | Regret: 0.6112 | Best: 0.5794 | LR: 8.59e-05
Episode  3000 | Reward:  12.37 | Regret: 0.5613 | Best: 0.5557 | LR: 8.54e-05

模型已保存: ./runs/ppo_bo_1216v3_2/ppo_ep3000.pt

Episode  3020 | Reward:  12.37 | Regret: 0.6064 | Best: 0.5557 | LR: 8.48e-05
Episode  3040 | Reward:  12.16 | Regret: 0.6459 | Best: 0.5557 | LR: 8.42e-05
Episode  3060 | Reward:  12.12 | Regret: 0.6064 | Best: 0.5557 | LR: 8.37e-05
Episode  3080 | Reward:  12.47 | Regret: 0.6005 | Best: 0.5557 | LR: 8.31e-05
Episode  3100 | Reward:  12.85 | Regret: 0.5278 | Best: 0.5114 | LR: 8.25e-05
Episode  3120 | Reward:  13.29 | Regret: 0.5013 | Best: 0.5002 | LR: 8.19e-05
Episode  3140 | Reward:  13.55 | Regret: 0.4694 | Best: 0.4688 | LR: 8.13e-05
Episode  3160 | Reward:  13.66 | Regret: 0.4773 | Best: 0.4688 | LR: 8.06e-05
Episode  3180 | Reward:  14.40 | Regret: 0.4353 | Best: 0.4353 | LR: 8.00e-05
Episode  3200 | Reward:  14.61 | Regret: 0.4632 | Best: 0.4196 | LR: 7.94e-05
Episode  3220 | Reward:  14.66 | Regret: 0.4036 | Best: 0.3993 | LR: 7.88e-05
Episode  3240 | Reward:  14.99 | Regret: 0.3676 | Best: 0.3606 | LR: 7.81e-05
Episode  3260 | Reward:  15.39 | Regret: 0.3410 | Best: 0.3410 | LR: 7.75e-05
Episode  3280 | Reward:  15.67 | Regret: 0.3503 | Best: 0.3344 | LR: 7.68e-05
Episode  3300 | Reward:  15.77 | Regret: 0.2894 | Best: 0.2894 | LR: 7.61e-05
Episode  3320 | Reward:  15.66 | Regret: 0.3017 | Best: 0.2779 | LR: 7.55e-05
Episode  3340 | Reward:  15.16 | Regret: 0.3213 | Best: 0.2779 | LR: 7.48e-05
Episode  3360 | Reward:  14.43 | Regret: 0.3308 | Best: 0.2779 | LR: 7.41e-05
Episode  3380 | Reward:  14.14 | Regret: 0.3452 | Best: 0.2779 | LR: 7.34e-05
Episode  3400 | Reward:  14.44 | Regret: 0.3501 | Best: 0.2779 | LR: 7.27e-05
Episode  3420 | Reward:  14.84 | Regret: 0.3621 | Best: 0.2779 | LR: 7.20e-05
Episode  3440 | Reward:  15.50 | Regret: 0.3365 | Best: 0.2779 | LR: 7.13e-05
Episode  3460 | Reward:  16.09 | Regret: 0.3463 | Best: 0.2779 | LR: 7.06e-05
Episode  3480 | Reward:  14.96 | Regret: 0.3728 | Best: 0.2779 | LR: 6.99e-05
Episode  3500 | Reward:  14.53 | Regret: 0.3783 | Best: 0.2779 | LR: 6.91e-05

模型已保存: ./runs/ppo_bo_1216v3_2/ppo_ep3500.pt

Episode  3520 | Reward:  14.26 | Regret: 0.3557 | Best: 0.2779 | LR: 6.84e-05
Episode  3540 | Reward:  13.76 | Regret: 0.3852 | Best: 0.2779 | LR: 6.77e-05
Episode  3560 | Reward:  13.37 | Regret: 0.3902 | Best: 0.2779 | LR: 6.69e-05
Episode  3580 | Reward:  14.11 | Regret: 0.3904 | Best: 0.2779 | LR: 6.62e-05
Episode  3600 | Reward:  13.97 | Regret: 0.3747 | Best: 0.2779 | LR: 6.55e-05
Episode  3620 | Reward:  14.24 | Regret: 0.3780 | Best: 0.2779 | LR: 6.47e-05
Episode  3640 | Reward:  14.22 | Regret: 0.3574 | Best: 0.2779 | LR: 6.39e-05
Episode  3660 | Reward:  14.49 | Regret: 0.3419 | Best: 0.2779 | LR: 6.32e-05
Episode  3680 | Reward:  14.06 | Regret: 0.3147 | Best: 0.2779 | LR: 6.24e-05
Episode  3700 | Reward:  14.07 | Regret: 0.3195 | Best: 0.2779 | LR: 6.17e-05
Episode  3720 | Reward:  13.90 | Regret: 0.3316 | Best: 0.2779 | LR: 6.09e-05
Episode  3740 | Reward:  14.02 | Regret: 0.3491 | Best: 0.2779 | LR: 6.01e-05
Episode  3760 | Reward:  14.24 | Regret: 0.3655 | Best: 0.2779 | LR: 5.94e-05
Episode  3780 | Reward:  14.87 | Regret: 0.3534 | Best: 0.2779 | LR: 5.86e-05
Episode  3800 | Reward:  14.72 | Regret: 0.3517 | Best: 0.2779 | LR: 5.78e-05
Episode  3820 | Reward:  14.82 | Regret: 0.3323 | Best: 0.2779 | LR: 5.70e-05
Episode  3840 | Reward:  15.43 | Regret: 0.3054 | Best: 0.2779 | LR: 5.63e-05
Episode  3860 | Reward:  15.87 | Regret: 0.2510 | Best: 0.2510 | LR: 5.55e-05
Episode  3880 | Reward:  16.31 | Regret: 0.2557 | Best: 0.2299 | LR: 5.47e-05
Episode  3900 | Reward:  16.57 | Regret: 0.2596 | Best: 0.2299 | LR: 5.39e-05
Episode  3920 | Reward:  16.68 | Regret: 0.2532 | Best: 0.2299 | LR: 5.31e-05
Episode  3940 | Reward:  16.48 | Regret: 0.2668 | Best: 0.2299 | LR: 5.24e-05
Episode  3960 | Reward:  15.95 | Regret: 0.3540 | Best: 0.2299 | LR: 5.16e-05
Episode  3980 | Reward:  15.56 | Regret: 0.3534 | Best: 0.2299 | LR: 5.08e-05
Episode  4000 | Reward:  15.75 | Regret: 0.3341 | Best: 0.2299 | LR: 5.00e-05

模型已保存: ./runs/ppo_bo_1216v3_2/ppo_ep4000.pt

Episode  4020 | Reward:  15.81 | Regret: 0.3644 | Best: 0.2299 | LR: 4.92e-05
Episode  4040 | Reward:  15.45 | Regret: 0.3321 | Best: 0.2299 | LR: 4.84e-05
Episode  4060 | Reward:  15.67 | Regret: 0.2524 | Best: 0.2299 | LR: 4.76e-05
Episode  4080 | Reward:  15.89 | Regret: 0.2351 | Best: 0.2299 | LR: 4.69e-05
Episode  4100 | Reward:  16.03 | Regret: 0.2512 | Best: 0.2299 | LR: 4.61e-05
Episode  4120 | Reward:  15.72 | Regret: 0.2300 | Best: 0.2299 | LR: 4.53e-05
Episode  4140 | Reward:  16.27 | Regret: 0.2255 | Best: 0.2255 | LR: 4.45e-05
Episode  4160 | Reward:  15.76 | Regret: 0.2565 | Best: 0.2158 | LR: 4.37e-05
Episode  4180 | Reward:  15.42 | Regret: 0.2592 | Best: 0.2158 | LR: 4.30e-05
Episode  4200 | Reward:  15.67 | Regret: 0.2406 | Best: 0.2158 | LR: 4.22e-05
Episode  4220 | Reward:  15.96 | Regret: 0.2349 | Best: 0.2158 | LR: 4.14e-05
Episode  4240 | Reward:  15.91 | Regret: 0.2341 | Best: 0.2158 | LR: 4.06e-05
Episode  4260 | Reward:  16.39 | Regret: 0.2124 | Best: 0.2060 | LR: 3.99e-05
Episode  4280 | Reward:  16.38 | Regret: 0.2266 | Best: 0.2060 | LR: 3.91e-05
Episode  4300 | Reward:  16.27 | Regret: 0.2235 | Best: 0.2060 | LR: 3.83e-05
Episode  4320 | Reward:  16.72 | Regret: 0.2306 | Best: 0.2060 | LR: 3.76e-05
Episode  4340 | Reward:  16.69 | Regret: 0.2352 | Best: 0.2060 | LR: 3.68e-05
Episode  4360 | Reward:  16.26 | Regret: 0.3069 | Best: 0.2060 | LR: 3.61e-05
Episode  4380 | Reward:  16.32 | Regret: 0.2985 | Best: 0.2060 | LR: 3.53e-05
Episode  4400 | Reward:  16.13 | Regret: 0.3194 | Best: 0.2060 | LR: 3.45e-05
Episode  4420 | Reward:  15.36 | Regret: 0.3309 | Best: 0.2060 | LR: 3.38e-05
Episode  4440 | Reward:  15.01 | Regret: 0.3296 | Best: 0.2060 | LR: 3.31e-05
Episode  4460 | Reward:  15.13 | Regret: 0.2654 | Best: 0.2060 | LR: 3.23e-05
Episode  4480 | Reward:  15.45 | Regret: 0.2591 | Best: 0.2060 | LR: 3.16e-05
Episode  4500 | Reward:  15.67 | Regret: 0.2481 | Best: 0.2060 | LR: 3.09e-05

模型已保存: ./runs/ppo_bo_1216v3_2/ppo_ep4500.pt

Episode  4520 | Reward:  15.80 | Regret: 0.2634 | Best: 0.2060 | LR: 3.01e-05
Episode  4540 | Reward:  15.68 | Regret: 0.2755 | Best: 0.2060 | LR: 2.94e-05
Episode  4560 | Reward:  15.58 | Regret: 0.2666 | Best: 0.2060 | LR: 2.87e-05
Episode  4580 | Reward:  14.86 | Regret: 0.3084 | Best: 0.2060 | LR: 2.80e-05
Episode  4600 | Reward:  14.01 | Regret: 0.3287 | Best: 0.2060 | LR: 2.73e-05
Episode  4620 | Reward:  14.30 | Regret: 0.3036 | Best: 0.2060 | LR: 2.66e-05
Episode  4640 | Reward:  14.48 | Regret: 0.2888 | Best: 0.2060 | LR: 2.59e-05
Episode  4660 | Reward:  14.89 | Regret: 0.2786 | Best: 0.2060 | LR: 2.52e-05
Episode  4680 | Reward:  15.18 | Regret: 0.2357 | Best: 0.2060 | LR: 2.45e-05
Episode  4700 | Reward:  15.42 | Regret: 0.2328 | Best: 0.2060 | LR: 2.39e-05
Episode  4720 | Reward:  15.37 | Regret: 0.2148 | Best: 0.2060 | LR: 2.32e-05
Episode  4740 | Reward:  15.80 | Regret: 0.2170 | Best: 0.2060 | LR: 2.25e-05
Episode  4760 | Reward:  15.45 | Regret: 0.2558 | Best: 0.2060 | LR: 2.19e-05
Episode  4780 | Reward:  15.51 | Regret: 0.2926 | Best: 0.2060 | LR: 2.12e-05
Episode  4800 | Reward:  15.77 | Regret: 0.2808 | Best: 0.2060 | LR: 2.06e-05
Episode  4820 | Reward:  15.72 | Regret: 0.3065 | Best: 0.2060 | LR: 2.00e-05
Episode  4840 | Reward:  15.98 | Regret: 0.3085 | Best: 0.2060 | LR: 1.94e-05
Episode  4860 | Reward:  16.23 | Regret: 0.3849 | Best: 0.2060 | LR: 1.87e-05
Episode  4880 | Reward:  16.47 | Regret: 0.3714 | Best: 0.2060 | LR: 1.81e-05
Episode  4900 | Reward:  17.31 | Regret: 0.3811 | Best: 0.2060 | LR: 1.75e-05
Episode  4920 | Reward:  17.56 | Regret: 0.3574 | Best: 0.2060 | LR: 1.69e-05
Episode  4940 | Reward:  17.00 | Regret: 0.3794 | Best: 0.2060 | LR: 1.63e-05
Episode  4960 | Reward:  17.71 | Regret: 0.2904 | Best: 0.2060 | LR: 1.58e-05
Episode  4980 | Reward:  18.11 | Regret: 0.2541 | Best: 0.2060 | LR: 1.52e-05
Episode  5000 | Reward:  18.14 | Regret: 0.2184 | Best: 0.2060 | LR: 1.46e-05

模型已保存: ./runs/ppo_bo_1216v3_2/ppo_ep5000.pt


最终模型已保存: ./runs/ppo_bo_1216v3_2/ppo_final.pt
TensorBoard writer 已关闭
+ cleanup
++ date +%s
+ end_time=1766049127
+ runtime=15603
++ date
++ hostname
+ echo '任务在 Thu Dec 18 04:12:07 EST 2025 结束或中断 (hostname=r4518u01n01.misha.ycrc.yale.edu)'
任务在 Thu Dec 18 04:12:07 EST 2025 结束或中断 (hostname=r4518u01n01.misha.ycrc.yale.edu)
+ echo '总耗时: 4 小时 20 分钟 3 秒'
总耗时: 4 小时 20 分钟 3 秒
